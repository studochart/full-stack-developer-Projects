<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Budget Tracker - StudoChart</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
        }
        
        header {
            background-color: #091330;
            color: white;
            padding: 20px;
            text-align: center;
            border-radius: 8px;
            margin-bottom: 30px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        h1, h2, h3, h4, h5, h6 {
            color: #5592f5;
            margin-top: 1.5em;
            margin-bottom: 0.5em;
        }
        
        h1 {
            color: white;
            margin-top: 0;
        }
        
        .container {
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        
        .example {
            background-color: #f0f5ff;
            border-left: 4px solid #5592f5;
            padding: 15px;
            margin: 20px 0;
            border-radius: 0 8px 8px 0;
        }
        
        button {
            background-color: #5592f5;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
        }
        
        button:hover {
            background-color: #09cc09;
        }
        
        input, select, textarea {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
            margin: 5px;
            width: 100%;
            box-sizing: border-box;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-row {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .form-row label {
            min-width: 120px;
        }
        
        .form-row input, .form-row select {
            flex: 1;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        th {
            background-color: #f0f5ff;
            color: #5592f5;
        }
        
        tr:hover {
            background-color: #f5f5f5;
        }
        
        .amount-positive {
            color: #4caf50;
            font-weight: bold;
        }
        
        .amount-negative {
            color: #f44336;
            font-weight: bold;
        }
        
        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .dashboard-card {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .dashboard-value {
            font-size: 28px;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .dashboard-label {
            color: #5592f5;
            font-weight: bold;
        }
        
        .progress-container {
            width: 100%;
            height: 10px;
            background-color: #f0f0f0;
            border-radius: 5px;
            margin: 10px 0;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            border-radius: 5px;
            transition: width 0.3s ease;
        }
        
        .progress-bar.good {
            background-color: #4caf50;
        }
        
        .progress-bar.warning {
            background-color: #ff9800;
        }
        
        .progress-bar.danger {
            background-color: #f44336;
        }
        
        .tab-container {
            margin-bottom: 20px;
        }
        
        .tabs {
            display: flex;
            border-bottom: 1px solid #ddd;
        }
        
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            background-color: #f5f5f5;
            border: 1px solid #ddd;
            border-bottom: none;
            border-radius: 4px 4px 0 0;
            margin-right: 5px;
        }
        
        .tab.active {
            background-color: #5592f5;
            color: white;
            border-color: #5592f5;
        }
        
        .tab-content {
            display: none;
            padding: 20px 0;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .chart-container {
            height: 300px;
            margin: 20px 0;
            position: relative;
        }
        
        .bar-chart {
            display: flex;
            height: 250px;
            align-items: flex-end;
            gap: 10px;
            padding-top: 20px;
        }
        
        .bar {
            flex: 1;
            min-width: 40px;
            position: relative;
            border-radius: 4px 4px 0 0;
            transition: height 0.5s ease;
        }
        
        .bar.income {
            background-color: #4caf50;
        }
        
        .bar.expense {
            background-color: #f44336;
        }
        
        .bar-label {
            position: absolute;
            top: -25px;
            left: 0;
            right: 0;
            text-align: center;
            font-weight: bold;
            font-size: 12px;
        }
        
        .bar-value {
            position: absolute;
            bottom: -25px;
            left: 0;
            right: 0;
            text-align: center;
            font-size: 12px;
        }
        
        .chart-y-axis {
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            padding-right: 10px;
            height: 250px;
            font-size: 12px;
            color: #666;
        }
        
        .pie-chart {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            background: conic-gradient(#f44336 0% 30%, #ff9800 30% 45%, #4caf50 45% 55%, #2196f3 55% 70%, #9c27b0 70% 85%, #795548 85% 100%);
            margin: 20px auto;
        }
        
        .chart-legend {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            margin-right: 15px;
        }
        
        .legend-color {
            width: 15px;
            height: 15px;
            border-radius: 3px;
            margin-right: 5px;
        }
        
        .filter-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .filter-group {
            flex: 1;
            min-width: 200px;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            width: 90%;
            max-width: 500px;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .modal-title {
            font-size: 20px;
            color: #5592f5;
            margin: 0;
        }
        
        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
        }
        
        .close-btn:hover {
            color: #333;
        }
        
        .category-tag {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 20px;
            color: white;
            font-size: 12px;
            margin-right: 5px;
        }
        
        .category-food {
            background-color: #f44336;
        }
        
        .category-housing {
            background-color: #ff9800;
        }
        
        .category-transportation {
            background-color: #4caf50;
        }
        
        .category-education {
            background-color: #2196f3;
        }
        
        .category-entertainment {
            background-color: #9c27b0;
        }
        
        .category-other {
            background-color: #795548;
        }
        
        .category-income {
            background-color: #4caf50;
        }
        
        footer {
            margin-top: 50px;
            text-align: center;
            color: #666;
            border-top: 1px solid #ddd;
            padding-top: 20px;
        }
        
        @media (max-width: 768px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
            
            .form-row {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .form-row label {
                min-width: auto;
                margin-bottom: 5px;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>Student Budget Tracker</h1>
        <p>Track your income and expenses to manage your finances better</p>
    </header>

    <div class="container">
        <div class="tab-container">
            <div class="tabs">
                <div class="tab active" data-tab="dashboard">Dashboard</div>
                <div class="tab" data-tab="transactions">Transactions</div>
                <div class="tab" data-tab="budget">Budget</div>
                <div class="tab" data-tab="reports">Reports</div>
            </div>
            
            <div class="tab-content active" id="dashboard-tab">
                <h2>Financial Overview</h2>
                
                <div class="dashboard">
                    <div class="dashboard-card">
                        <div class="dashboard-label">Current Balance</div>
                        <div class="dashboard-value" id="currentBalance">$0.00</div>
                    </div>
                    
                    <div class="dashboard-card">
                        <div class="dashboard-label">Monthly Income</div>
                        <div class="dashboard-value amount-positive" id="monthlyIncome">$0.00</div>
                    </div>
                    
                    <div class="dashboard-card">
                        <div class="dashboard-label">Monthly Expenses</div>
                        <div class="dashboard-value amount-negative" id="monthlyExpenses">$0.00</div>
                    </div>
                    
                    <div class="dashboard-card">
                        <div class="dashboard-label">Savings Rate</div>
                        <div class="dashboard-value" id="savingsRate">0%</div>
                    </div>
                </div>
                
                <div class="example">
                    <h3>Budget Progress</h3>
                    <div id="budgetProgressContainer">
                        <!-- Budget progress bars will be added here -->
                    </div>
                </div>
                
                <h3>Recent Transactions</h3>
                <table id="recentTransactionsTable">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Description</th>
                            <th>Category</th>
                            <th>Amount</th>
                        </tr>
                    </thead>
                    <tbody id="recentTransactionsBody">
                        <!-- Recent transactions will be listed here -->
                    </tbody>
                </table>
                
                <div style="text-align: center; margin-top: 20px;">
                    <button id="addTransactionBtn">Add New Transaction</button>
                </div>
            </div>
            
            <div class="tab-content" id="transactions-tab">
                <h2>All Transactions</h2>
                
                <div class="filter-controls">
                    <div class="filter-group">
                        <label for="transactionTypeFilter">Type:</label>
                        <select id="transactionTypeFilter">
                            <option value="all">All</option>
                            <option value="income">Income</option>
                            <option value="expense">Expense</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label for="categoryFilter">Category:</label>
                        <select id="categoryFilter">
                            <option value="all">All Categories</option>
                            <option value="income">Income</option>
                            <option value="food">Food</option>
                            <option value="housing">Housing</option>
                            <option value="transportation">Transportation</option>
                            <option value="education">Education</option>
                            <option value="entertainment">Entertainment</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label for="dateRangeFilter">Date Range:</label>
                        <select id="dateRangeFilter">
                            <option value="all">All Time</option>
                            <option value="thisMonth">This Month</option>
                            <option value="lastMonth">Last Month</option>
                            <option value="thisYear">This Year</option>
                        </select>
                    </div>
                </div>
                
                <table id="transactionsTable">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Description</th>
                            <th>Category</th>
                            <th>Amount</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="transactionsTableBody">
                        <!-- Transactions will be listed here -->
                    </tbody>
                </table>
                
                <div style="text-align: center; margin-top: 20px;">
                    <button id="addTransactionBtn2">Add New Transaction</button>
                </div>
            </div>
            
            <div class="tab-content" id="budget-tab">
                <h2>Monthly Budget</h2>
                
                <div class="example">
                    <p>Set your monthly budget limits for each category to help manage your spending.</p>
                </div>
                
                <form id="budgetForm">
                    <div class="form-group">
                        <div class="form-row">
                            <label for="foodBudget">Food:</label>
                            <input type="number" id="foodBudget" min="0" step="0.01" placeholder="0.00">
                        </div>
                        
                        <div class="form-row">
                            <label for="housingBudget">Housing:</label>
                            <input type="number" id="housingBudget" min="0" step="0.01" placeholder="0.00">
                        </div>
                        
                        <div class="form-row">
                            <label for="transportationBudget">Transportation:</label>
                            <input type="number" id="transportationBudget" min="0" step="0.01" placeholder="0.00">
                        </div>
                        
                        <div class="form-row">
                            <label for="educationBudget">Education:</label>
                            <input type="number" id="educationBudget" min="0" step="0.01" placeholder="0.00">
                        </div>
                        
                        <div class="form-row">
                            <label for="entertainmentBudget">Entertainment:</label>
                            <input type="number" id="entertainmentBudget" min="0" step="0.01" placeholder="0.00">
                        </div>
                        
                        <div class="form-row">
                            <label for="otherBudget">Other:</label>
                            <input type="number" id="otherBudget" min="0" step="0.01" placeholder="0.00">
                        </div>
                    </div>
                    
                    <button type="submit" id="saveBudgetBtn">Save Budget</button>
                </form>
                
                <div class="chart-container">
                    <h3>Budget Allocation</h3>
                    <div class="pie-chart" id="budgetPieChart"></div>
                    <div class="chart-legend" id="budgetChartLegend">
                        <!-- Legend items will be added here -->
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="reports-tab">
                <h2>Financial Reports</h2>
                
                <div class="filter-controls">
                    <div class="filter-group">
                        <label for="reportDateRange">Date Range:</label>
                        <select id="reportDateRange">
                            <option value="thisMonth">This Month</option>
                            <option value="lastMonth">Last Month</option>
                            <option value="last3Months">Last 3 Months</option>
                            <option value="thisYear">This Year</option>
                            <option value="all">All Time</option>
                        </select>
                    </div>
                </div>
                
                <div class="chart-container">
                    <h3>Income vs. Expenses</h3>
                    <div style="display: flex;">
                        <div class="chart-y-axis">
                            <div>$1000</div>
                            <div>$750</div>
                            <div>$500</div>
                            <div>$250</div>
                            <div>$0</div>
                        </div>
                        <div class="bar-chart" id="incomeExpenseChart">
                            <!-- Bars will be added here -->
                        </div>
                    </div>
                </div>
                
                <div class="chart-container">
                    <h3>Expense Breakdown</h3>
                    <div class="pie-chart" id="expensePieChart"></div>
                    <div class="chart-legend" id="expenseChartLegend">
                        <!-- Legend items will be added here -->
                    </div>
                </div>
                
                <div class="example">
                    <h3>Spending Insights</h3>
                    <div id="spendingInsights">
                        <!-- Insights will be added here -->
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Transaction Modal -->
    <div class="modal" id="transactionModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="modalTitle">Add New Transaction</h3>
                <button class="close-btn" id="closeModal">&times;</button>
            </div>
            
            <form id="transactionForm">
                <div class="form-group">
                    <div class="form-row">
                        <label for="transactionType">Type:</label>
                        <select id="transactionType" required>
                            <option value="income">Income</option>
                            <option value="expense">Expense</option>
                        </select>
                    </div>
                    
                    <div class="form-row">
                        <label for="transactionDate">Date:</label>
                        <input type="date" id="transactionDate" required>
                    </div>
                    
                    <div class="form-row">
                        <label for="transactionAmount">Amount:</label>
                        <input type="number" id="transactionAmount" min="0.01" step="0.01" placeholder="0.00" required>
                    </div>
                    
                    <div class="form-row">
                        <label for="transactionDescription">Description:</label>
                        <input type="text" id="transactionDescription" placeholder="e.g., Grocery shopping" required>
                    </div>
                    
                    <div class="form-row">
                        <label for="transactionCategory">Category:</label>
                        <select id="transactionCategory" required>
                            <option value="income">Income</option>
                            <option value="food">Food</option>
                            <option value="housing">Housing</option>
                            <option value="transportation">Transportation</option>
                            <option value="education">Education</option>
                            <option value="entertainment">Entertainment</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    
                    <div class="form-row">
                        <label for="transactionNotes">Notes:</label>
                        <textarea id="transactionNotes" placeholder="Additional details (optional)"></textarea>
                    </div>
                </div>
                
                <button type="submit" id="saveTransactionBtn">Save Transaction</button>
            </form>
        </div>
    </div>

    <footer>
        <p>&copy; 2023 StudoChart - Student Budget Tracker. All rights reserved.</p>
        <p>This project is designed for educational purposes to help students manage their finances.</p>
    </footer>

    <script>
        // DOM Elements
        const tabs = document.querySelectorAll('.tab');
        const tabContents = document.querySelectorAll('.tab-content');
        
        // Dashboard elements
        const currentBalanceEl = document.getElementById('currentBalance');
        const monthlyIncomeEl = document.getElementById('monthlyIncome');
        const monthlyExpensesEl = document.getElementById('monthlyExpenses');
        const savingsRateEl = document.getElementById('savingsRate');
        const budgetProgressContainer = document.getElementById('budgetProgressContainer');
        const recentTransactionsBody = document.getElementById('recentTransactionsBody');
        
        // Transactions tab elements
        const transactionTypeFilter = document.getElementById('transactionTypeFilter');
        const categoryFilter = document.getElementById('categoryFilter');
        const dateRangeFilter = document.getElementById('dateRangeFilter');
        const transactionsTableBody = document.getElementById('transactionsTableBody');
        
        // Budget tab elements
        const budgetForm = document.getElementById('budgetForm');
        const foodBudgetInput = document.getElementById('foodBudget');
        const housingBudgetInput = document.getElementById('housingBudget');
        const transportationBudgetInput = document.getElementById('transportationBudget');
        const educationBudgetInput = document.getElementById('educationBudget');
        const entertainmentBudgetInput = document.getElementById('entertainmentBudget');
        const otherBudgetInput = document.getElementById('otherBudget');
        const budgetPieChart = document.getElementById('budgetPieChart');
        const budgetChartLegend = document.getElementById('budgetChartLegend');
        
        // Reports tab elements
        const reportDateRange = document.getElementById('reportDateRange');
        const incomeExpenseChart = document.getElementById('incomeExpenseChart');
        const expensePieChart = document.getElementById('expensePieChart');
        const expenseChartLegend = document.getElementById('expenseChartLegend');
        const spendingInsights = document.getElementById('spendingInsights');
        
        // Transaction modal elements
        const transactionModal = document.getElementById('transactionModal');
        const closeModal = document.getElementById('closeModal');
        const modalTitle = document.getElementById('modalTitle');
        const transactionForm = document.getElementById('transactionForm');
        const transactionType = document.getElementById('transactionType');
        const transactionDate = document.getElementById('transactionDate');
        const transactionAmount = document.getElementById('transactionAmount');
        const transactionDescription = document.getElementById('transactionDescription');
        const transactionCategory = document.getElementById('transactionCategory');
        const transactionNotes = document.getElementById('transactionNotes');
        const addTransactionBtn = document.getElementById('addTransactionBtn');
        const addTransactionBtn2 = document.getElementById('addTransactionBtn2');
        
        // State variables
        let transactions = JSON.parse(localStorage.getItem('budget-transactions')) || [];
        let budget = JSON.parse(localStorage.getItem('budget-settings')) || {
            food: 0,
            housing: 0,
            transportation: 0,
            education: 0,
            entertainment: 0,
            other: 0
        };
        let editingTransactionId = null;
        
        // Category colors
        const categoryColors = {
            income: '#4caf50',
            food: '#f44336',
            housing: '#ff9800',
            transportation: '#4caf50',
            education: '#2196f3',
            entertainment: '#9c27b0',
            other: '#795548'
        };
        
        // Tab switching
        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                tabs.forEach(t => t.classList.remove('active'));
                tabContents.forEach(tc => tc.classList.remove('active'));
                
                tab.classList.add('active');
                const tabId = tab.getAttribute('data-tab');
                document.getElementById(`${tabId}-tab`).classList.add('active');
                
                // Refresh data when switching tabs
                if (tabId === 'dashboard') {
                    updateDashboard();
                } else if (tabId === 'transactions') {
                    updateTransactionsTable();
                } else if (tabId === 'budget') {
                    updateBudgetForm();
                    updateBudgetChart();
                } else if (tabId === 'reports') {
                    updateReports();
                }
            });
        });
        
        // Transaction modal
        addTransactionBtn.addEventListener('click', openTransactionModal);
        addTransactionBtn2.addEventListener('click', openTransactionModal);
        closeModal.addEventListener('click', closeTransactionModal);
        
        // Close modal when clicking outside
        window.addEventListener('click', (e) => {
            if (e.target === transactionModal) {
                closeTransactionModal();
            }
        });
        
        // Transaction type change
        transactionType.addEventListener('change', () => {
            if (transactionType.value === 'income') {
                transactionCategory.value = 'income';
                transactionCategory.disabled = true;
            } else {
                transactionCategory.disabled = false;
                if (transactionCategory.value === 'income') {
                    transactionCategory.value = 'food';
                }
            }
        });
        
        // Transaction form submission
        transactionForm.addEventListener('submit', (e) => {
            e.preventDefault();
            
            const amount = parseFloat(transactionAmount.value);
            
            const transaction = {
                id: editingTransactionId || Date.now().toString(),
                type: transactionType.value,
                date: transactionDate.value,
                amount: amount,
                description: transactionDescription.value,
                category: transactionCategory.value,
                notes: transactionNotes.value
            };
            
            if (editingTransactionId) {
                // Update existing transaction
                const index = transactions.findIndex(t => t.id === editingTransactionId);
                if (index !== -1) {
                    transactions[index] = transaction;
                }
                editingTransactionId = null;
            } else {
                // Add new transaction
                transactions.push(transaction);
            }
            
            saveTransactions();
            closeTransactionModal();
            
            // Update current tab
            const activeTab = document.querySelector('.tab.active').getAttribute('data-tab');
            if (activeTab === 'dashboard') {
                updateDashboard();
            } else if (activeTab === 'transactions') {
                updateTransactionsTable();
            } else if (activeTab === 'reports') {
                updateReports();
            }
        });
        
        // Budget form submission
        budgetForm.addEventListener('submit', (e) => {
            e.preventDefault();
            
            budget = {
                food: parseFloat(foodBudgetInput.value) || 0,
                housing: parseFloat(housingBudgetInput.value) || 0,
                transportation: parseFloat(transportationBudgetInput.value) || 0,
                education: parseFloat(educationBudgetInput.value) || 0,
                entertainment: parseFloat(entertainmentBudgetInput.value) || 0,
                other: parseFloat(otherBudgetInput.value) || 0
            };
            
            saveBudget();
            updateBudgetChart();
            updateDashboard();
            
            alert('Budget saved successfully!');
        });
        
        // Filter change events
        transactionTypeFilter.addEventListener('change', updateTransactionsTable);
        categoryFilter.addEventListener('change', updateTransactionsTable);
        dateRangeFilter.addEventListener('change', updateTransactionsTable);
        reportDateRange.addEventListener('change', updateReports);
        
        // Save transactions to localStorage
        function saveTransactions() {
            localStorage.setItem('budget-transactions', JSON.stringify(transactions));
        }
        
        // Save budget to localStorage
        function saveBudget() {
            localStorage.setItem('budget-settings', JSON.stringify(budget));
        }
        
        // Open transaction modal
        function openTransactionModal() {
            modalTitle.textContent = 'Add New Transaction';
            transactionForm.reset();
            
            // Set default date to today
            const today = new Date().toISOString().split('T')[0];
            transactionDate.value = today;
            
            // Reset editing state
            editingTransactionId = null;
            
            // Show modal
            transactionModal.style.display = 'flex';
        }
        
        // Close transaction modal
        function closeTransactionModal() {
            transactionModal.style.display = 'none';
        }
        
        // Edit transaction
        function editTransaction(id) {
            const transaction = transactions.find(t => t.id === id);
            if (!transaction) return;
            
            modalTitle.textContent = 'Edit Transaction';
            
            transactionType.value = transaction.type;
            transactionDate.value = transaction.date;
            transactionAmount.value = transaction.amount;
            transactionDescription.value = transaction.description;
            transactionCategory.value = transaction.category;
            transactionNotes.value = transaction.notes || '';
            
            // Disable category if type is income
            if (transaction.type === 'income') {
                transactionCategory.disabled = true;
            } else {
                transactionCategory.disabled = false;
            }
            
            // Set editing state
            editingTransactionId = id;
            
            // Show modal
            transactionModal.style.display = 'flex';
        }
        
        // Delete transaction
        function deleteTransaction(id) {
            if (confirm('Are you sure you want to delete this transaction?')) {
                transactions = transactions.filter(t => t.id !== id);
                saveTransactions();
                
                // Update current tab
                const activeTab = document.querySelector('.tab.active').getAttribute('data-tab');
                if (activeTab === 'dashboard') {
                    updateDashboard();
                } else if (activeTab === 'transactions') {
                    updateTransactionsTable();
                } else if (activeTab === 'reports') {
                    updateReports();
                }
            }
        }
        
        // Update dashboard
        function updateDashboard() {
            // Calculate current balance, monthly income, and expenses
            const currentDate = new Date();
            const currentMonth = currentDate.getMonth();
            const currentYear = currentDate.getFullYear();
            
            let totalBalance = 0;
            let monthlyIncome = 0;
            let monthlyExpenses = 0;
            
            transactions.forEach(transaction => {
                const transactionDate = new Date(transaction.date);
                const amount = parseFloat(transaction.amount);
                
                if (transaction.type === 'income') {
                    totalBalance += amount;
                    
                    if (transactionDate.getMonth() === currentMonth && 
                        transactionDate.getFullYear() === currentYear) {
                        monthlyIncome += amount;
                    }
                } else {
                    totalBalance -= amount;
                    
                    if (transactionDate.getMonth() === currentMonth && 
                        transactionDate.getFullYear() === currentYear) {
                        monthlyExpenses += amount;
                    }
                }
            });
            
            // Calculate savings rate
            const savingsRate = monthlyIncome > 0 ? ((monthlyIncome - monthlyExpenses) / monthlyIncome) * 100 : 0;
            
            // Update dashboard elements
            currentBalanceEl.textContent = formatCurrency(totalBalance);
            monthlyIncomeEl.textContent = formatCurrency(monthlyIncome);
            monthlyExpensesEl.textContent = formatCurrency(monthlyExpenses);
            savingsRateEl.textContent = `${savingsRate.toFixed(1)}%`;
            
            // Update budget progress
            updateBudgetProgress();
            
            // Update recent transactions
            updateRecentTransactions();
        }
        
        // Update budget progress
        function updateBudgetProgress() {
            budgetProgressContainer.innerHTML = '';
            
            // Get current month expenses by category
            const currentDate = new Date();
            const currentMonth = currentDate.getMonth();
            const currentYear = currentDate.getFullYear();
            
            const monthlyExpensesByCategory = {
                food: 0,
                housing: 0,
                transportation: 0,
                education: 0,
                entertainment: 0,
                other: 0
            };
            
            transactions.forEach(transaction => {
                if (transaction.type === 'expense') {
                    const transactionDate = new Date(transaction.date);
                    
                    if (transactionDate.getMonth() === currentMonth && 
                        transactionDate.getFullYear() === currentYear) {
                        const category = transaction.category;
                        const amount = parseFloat(transaction.amount);
                        
                        if (monthlyExpensesByCategory.hasOwnProperty(category)) {
                            monthlyExpensesByCategory[category] += amount;
                        }
                    }
                }
            });
            
            // Create progress bars for each category
            Object.keys(budget).forEach(category => {
                const budgetAmount = budget[category];
                if (budgetAmount <= 0) return; // Skip categories with no budget
                
                const spent = monthlyExpensesByCategory[category];
                const percentage = (spent / budgetAmount) * 100;
                
                const categoryName = category.charAt(0).toUpperCase() + category.slice(1);
                
                const progressHtml = `
                    <div style="margin-bottom: 15px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                            <div>${categoryName}</div>
                            <div>${formatCurrency(spent)} / ${formatCurrency(budgetAmount)}</div>
                        </div>
                        <div class="progress-container">
                            <div class="progress-bar ${getProgressBarClass(percentage)}" style="width: ${Math.min(percentage, 100)}%"></div>
                        </div>
                    </div>
                `;
                
                budgetProgressContainer.innerHTML += progressHtml;
            });
            
            if (budgetProgressContainer.innerHTML === '') {
                budgetProgressContainer.innerHTML = '<p>No budget set. Go to the Budget tab to set your monthly budget.</p>';
            }
        }
        
        // Get progress bar class based on percentage
        function getProgressBarClass(percentage) {
            if (percentage < 70) return 'good';
            if (percentage < 90) return 'warning';
            return 'danger';
        }
        
        // Update recent transactions
        function updateRecentTransactions() {
            recentTransactionsBody.innerHTML = '';
            
            // Sort transactions by date (newest first)
            const sortedTransactions = [...transactions].sort((a, b) => new Date(b.date) - new Date(a.date));
            
            // Take only the 5 most recent transactions
            const recentTransactions = sortedTransactions.slice(0, 5);
            
            if (recentTransactions.length === 0) {
                const row = document.createElement('tr');
                row.innerHTML = '<td colspan="4">No transactions yet</td>';
                recentTransactionsBody.appendChild(row);
                return;
            }
            
            recentTransactions.forEach(transaction => {
                const row = document.createElement('tr');
                
                const amountClass = transaction.type === 'income' ? 'amount-positive' : 'amount-negative';
                const amountPrefix = transaction.type === 'income' ? '+' : '-';
                
                const categoryClass = `category-${transaction.category}`;
                const categoryTag = `<span class="category-tag ${categoryClass}">${transaction.category}</span>`;
                
                row.innerHTML = `
                    <td>${formatDate(transaction.date)}</td>
                    <td>${transaction.description}</td>
                    <td>${categoryTag}</td>
                    <td class="${amountClass}">${amountPrefix}${formatCurrency(transaction.amount)}</td>
                `;
                
                recentTransactionsBody.appendChild(row);
            });
        }
        
        // Update transactions table
        function updateTransactionsTable() {
            transactionsTableBody.innerHTML = '';
            
            // Apply filters
            let filteredTransactions = [...transactions];
            
            const typeFilter = transactionTypeFilter.value;
            const catFilter = categoryFilter.value;
            const dateFilter = dateRangeFilter.value;
            
            if (typeFilter !== 'all') {
                filteredTransactions = filteredTransactions.filter(t => t.type === typeFilter);
            }
            
            if (catFilter !== 'all') {
                filteredTransactions = filteredTransactions.filter(t => t.category === catFilter);
            }
            
            if (dateFilter !== 'all') {
                const currentDate = new Date();
                const currentMonth = currentDate.getMonth();
                const currentYear = currentDate.getFullYear();
                
                if (dateFilter === 'thisMonth') {
                    filteredTransactions = filteredTransactions.filter(t => {
                        const date = new Date(t.date);
                        return date.getMonth() === currentMonth && date.getFullYear() === currentYear;
                    });
                } else if (dateFilter === 'lastMonth') {
                    let lastMonth = currentMonth - 1;
                    let lastMonthYear = currentYear;
                    if (lastMonth < 0) {
                        lastMonth = 11;
                        lastMonthYear--;
                    }
                    
                    filteredTransactions = filteredTransactions.filter(t => {
                        const date = new Date(t.date);
                        return date.getMonth() === lastMonth && date.getFullYear() === lastMonthYear;
                    });
                } else if (dateFilter === 'thisYear') {
                    filteredTransactions = filteredTransactions.filter(t => {
                        const date = new Date(t.date);
                        return date.getFullYear() === currentYear;
                    });
                }
            }
            
            // Sort by date (newest first)
            filteredTransactions.sort((a, b) => new Date(b.date) - new Date(a.date));
            
            if (filteredTransactions.length === 0) {
                const row = document.createElement('tr');
                row.innerHTML = '<td colspan="5">No transactions found</td>';
                transactionsTableBody.appendChild(row);
                return;
            }
            
            filteredTransactions.forEach(transaction => {
                const row = document.createElement('tr');
                
                const amountClass = transaction.type === 'income' ? 'amount-positive' : 'amount-negative';
                const amountPrefix = transaction.type === 'income' ? '+' : '-';
                
                const categoryClass = `category-${transaction.category}`;
                const categoryTag = `<span class="category-tag ${categoryClass}">${transaction.category}</span>`;
                
                row.innerHTML = `
                    <td>${formatDate(transaction.date)}</td>
                    <td>${transaction.description}</td>
                    <td>${categoryTag}</td>
                    <td class="${amountClass}">${amountPrefix}${formatCurrency(transaction.amount)}</td>
                    <td>
                        <button class="edit-btn" data-id="${transaction.id}">Edit</button>
                        <button class="delete-btn" data-id="${transaction.id}">Delete</button>
                    </td>
                `;
                
                transactionsTableBody.appendChild(row);
            });
            
            // Add event listeners to buttons
            document.querySelectorAll('.edit-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    const id = btn.getAttribute('data-id');
                    editTransaction(id);
                });
            });
            
            document.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    const id = btn.getAttribute('data-id');
                    deleteTransaction(id);
                });
            });
        }
        
        // Update budget form
        function updateBudgetForm() {
            foodBudgetInput.value = budget.food;
            housingBudgetInput.value = budget.housing;
            transportationBudgetInput.value = budget.transportation;
            educationBudgetInput.value = budget.education;
            entertainmentBudgetInput.value = budget.entertainment;
            otherBudgetInput.value = budget.other;
        }
        
        // Update budget chart
        function updateBudgetChart() {
            // Calculate total budget
            const totalBudget = Object.values(budget).reduce((sum, value) => sum + value, 0);
            
            if (totalBudget === 0) {
                budgetPieChart.style.background = '#f0f0f0';
                budgetChartLegend.innerHTML = '<p>No budget set</p>';
                return;
            }
            
            // Create conic gradient for pie chart
            let conicGradient = '';
            let currentPercentage = 0;
            
            // Create legend items
            budgetChartLegend.innerHTML = '';
            
            Object.entries(budget).forEach(([category, amount]) => {
                if (amount <= 0) return;
                
                const percentage = (amount / totalBudget) * 100;
                const startPercentage = currentPercentage;
                const endPercentage = currentPercentage + percentage;
                
                conicGradient += `${categoryColors[category]} ${startPercentage}% ${endPercentage}%, `;
                currentPercentage = endPercentage;
                
                // Add legend item
                const legendItem = document.createElement('div');
                legendItem.className = 'legend-item';
                legendItem.innerHTML = `
                    <div class="legend-color" style="background-color: ${categoryColors[category]}"></div>
                    <div>${category.charAt(0).toUpperCase() + category.slice(1)} (${percentage.toFixed(1)}%)</div>
                `;
                
                budgetChartLegend.appendChild(legendItem);
            });
            
            // Remove trailing comma and space
            conicGradient = conicGradient.slice(0, -2);
            
            // Apply conic gradient
            budgetPieChart.style.background = `conic-gradient(${conicGradient})`;
        }
        
        // Update reports
        function updateReports() {
            updateIncomeExpenseChart();
            updateExpensePieChart();
            updateSpendingInsights();
        }
        
        // Update income vs expense chart
        function updateIncomeExpenseChart() {
            incomeExpenseChart.innerHTML = '';
            
            // Get date range
            const dateRange = getDateRangeForReport(reportDateRange.value);
            const { startDate, endDate, labels } = dateRange;
            
            // Calculate income and expenses for each period
            const incomeData = [];
            const expenseData = [];
            
            labels.forEach((label, index) => {
                let periodStart, periodEnd;
                
                if (reportDateRange.value === 'thisMonth' || reportDateRange.value === 'lastMonth') {
                    // For monthly view, calculate daily data
                    const year = startDate.getFullYear();
                    const month = startDate.getMonth();
                    const day = index + 1;
                    periodStart = new Date(year, month, day);
                    periodEnd = new Date(year, month, day + 1);
                } else if (reportDateRange.value === 'last3Months') {
                    // For 3-month view, calculate weekly data
                    periodStart = new Date(startDate);
                    periodStart.setDate(startDate.getDate() + (index * 7));
                    periodEnd = new Date(periodStart);
                    periodEnd.setDate(periodStart.getDate() + 7);
                } else {
                    // For yearly or all-time view, calculate monthly data
                    const year = startDate.getFullYear();
                    const month = startDate.getMonth() + index;
                    periodStart = new Date(year, month, 1);
                    periodEnd = new Date(year, month + 1, 0);
                }
                
                // Ensure we don't go beyond the end date
                if (periodEnd > endDate) {
                    periodEnd = endDate;
                }
                
                // Calculate income and expenses for this period
                let periodIncome = 0;
                let periodExpense = 0;
                
                transactions.forEach(transaction => {
                    const transactionDate = new Date(transaction.date);
                    
                    if (transactionDate >= periodStart && transactionDate < periodEnd) {
                        const amount = parseFloat(transaction.amount);
                        
                        if (transaction.type === 'income') {
                            periodIncome += amount;
                        } else {
                            periodExpense += amount;
                        }
                    }
                });
                
                incomeData.push(periodIncome);
                expenseData.push(periodExpense);
            });
            
            // Find max value for scaling
            const maxValue = Math.max(...incomeData, ...expenseData);
            
            // Create bars
            labels.forEach((label, index) => {
                // Income bar
                const incomeBar = document.createElement('div');
                incomeBar.className = 'bar income';
                incomeBar.style.height = `${(incomeData[index] / maxValue) * 100}%`;
                incomeBar.innerHTML = `
                    <div class="bar-label">${label}</div>
                    <div class="bar-value">${formatCurrency(incomeData[index])}</div>
                `;
                
                // Expense bar
                const expenseBar = document.createElement('div');
                expenseBar.className = 'bar expense';
                expenseBar.style.height = `${(expenseData[index] / maxValue) * 100}%`;
                expenseBar.innerHTML = `
                    <div class="bar-label">${label}</div>
                    <div class="bar-value">${formatCurrency(expenseData[index])}</div>
                `;
                
                incomeExpenseChart.appendChild(incomeBar);
                incomeExpenseChart.appendChild(expenseBar);
            });
        }
        
        // Update expense pie chart
        function updateExpensePieChart() {
            // Get date range
            const dateRange = getDateRangeForReport(reportDateRange.value);
            const { startDate, endDate } = dateRange;
            
            // Calculate expenses by category
            const expensesByCategory = {
                food: 0,
                housing: 0,
                transportation: 0,
                education: 0,
                entertainment: 0,
                other: 0
            };
            
            transactions.forEach(transaction => {
                if (transaction.type === 'expense') {
                    const transactionDate = new Date(transaction.date);
                    
                    if (transactionDate >= startDate && transactionDate <= endDate) {
                        const category = transaction.category;
                        const amount = parseFloat(transaction.amount);
                        
                        if (expensesByCategory.hasOwnProperty(category)) {
                            expensesByCategory[category] += amount;
                        }
                    }
                }
            });
            
            // Calculate total expenses
            const totalExpenses = Object.values(expensesByCategory).reduce((sum, value) => sum + value, 0);
            
            if (totalExpenses === 0) {
                expensePieChart.style.background = '#f0f0f0';
                expenseChartLegend.innerHTML = '<p>No expenses in this period</p>';
                return;
            }
            
            // Create conic gradient for pie chart
            let conicGradient = '';
            let currentPercentage = 0;
            
            // Create legend items
            expenseChartLegend.innerHTML = '';
            
            Object.entries(expensesByCategory).forEach(([category, amount]) => {
                if (amount <= 0) return;
                
                const percentage = (amount / totalExpenses) * 100;
                const startPercentage = currentPercentage;
                const endPercentage = currentPercentage + percentage;
                
                conicGradient += `${categoryColors[category]} ${startPercentage}% ${endPercentage}%, `;
                currentPercentage = endPercentage;
                
                // Add legend item
                const legendItem = document.createElement('div');
                legendItem.className = 'legend-item';
                legendItem.innerHTML = `
                    <div class="legend-color" style="background-color: ${categoryColors[category]}"></div>
                    <div>${category.charAt(0).toUpperCase() + category.slice(1)}: ${formatCurrency(amount)} (${percentage.toFixed(1)}%)</div>
                `;
                
                expenseChartLegend.appendChild(legendItem);
            });
            
            // Remove trailing comma and space
            conicGradient = conicGradient.slice(0, -2);
            
            // Apply conic gradient
            expensePieChart.style.background = `conic-gradient(${conicGradient})`;
        }
        
        // Update spending insights
        function updateSpendingInsights() {
            spendingInsights.innerHTML = '';
            
            // Get date range
            const dateRange = getDateRangeForReport(reportDateRange.value);
            const { startDate, endDate } = dateRange;
            
            // Calculate total income and expenses
            let totalIncome = 0;
            let totalExpenses = 0;
            
            // Calculate expenses by category
            const expensesByCategory = {
                food: 0,
                housing: 0,
                transportation: 0,
                education: 0,
                entertainment: 0,
                other: 0
            };
            
            transactions.forEach(transaction => {
                const transactionDate = new Date(transaction.date);
                
                if (transactionDate >= startDate && transactionDate <= endDate) {
                    const amount = parseFloat(transaction.amount);
                    
                    if (transaction.type === 'income') {
                        totalIncome += amount;
                    } else {
                        totalExpenses += amount;
                        
                        const category = transaction.category;
                        if (expensesByCategory.hasOwnProperty(category)) {
                            expensesByCategory[category] += amount;
                        }
                    }
                }
            });
            
            // Generate insights
            const insights = [];
            
            // Savings rate
            const savingsRate = totalIncome > 0 ? ((totalIncome - totalExpenses) / totalIncome) * 100 : 0;
            let savingsInsight;
            
            if (savingsRate >= 20) {
                savingsInsight = `Great job! Your savings rate is ${savingsRate.toFixed(1)}%, which is excellent.`;
            } else if (savingsRate >= 10) {
                savingsInsight = `Your savings rate is ${savingsRate.toFixed(1)}%, which is good but could be improved.`;
            } else if (savingsRate >= 0) {
                savingsInsight = `Your savings rate is only ${savingsRate.toFixed(1)}%. Try to increase your income or reduce expenses.`;
            } else {
                savingsInsight = `You're spending more than you earn. Your savings rate is ${savingsRate.toFixed(1)}%.`;
            }
            
            insights.push(savingsInsight);
            
            // Top spending category
            if (totalExpenses > 0) {
                const topCategory = Object.entries(expensesByCategory)
                    .sort((a, b) => b[1] - a[1])[0];
                
                const categoryName = topCategory[0].charAt(0).toUpperCase() + topCategory[0].slice(1);
                const categoryAmount = topCategory[1];
                const categoryPercentage = (categoryAmount / totalExpenses) * 100;
                
                insights.push(`Your highest spending category is ${categoryName} at ${formatCurrency(categoryAmount)} (${categoryPercentage.toFixed(1)}% of total expenses).`);
            }
            
            // Budget comparison
            const budgetInsights = [];
            
            Object.entries(expensesByCategory).forEach(([category, amount]) => {
                const budgetAmount = budget[category];
                
                if (budgetAmount > 0) {
                    const percentage = (amount / budgetAmount) * 100;
                    const categoryName = category.charAt(0).toUpperCase() + category.slice(1);
                    
                    if (percentage > 100) {
                        budgetInsights.push(`You've exceeded your ${categoryName} budget by ${formatCurrency(amount - budgetAmount)}.`);
                    } else if (percentage >= 90) {
                        budgetInsights.push(`You're close to your ${categoryName} budget limit (${percentage.toFixed(1)}% used).`);
                    }
                }
            });
            
            if (budgetInsights.length > 0) {
                insights.push(...budgetInsights);
            }
            
            // Render insights
            if (insights.length === 0) {
                spendingInsights.innerHTML = '<p>Not enough data to generate insights.</p>';
            } else {
                const insightsList = document.createElement('ul');
                
                insights.forEach(insight => {
                    const li = document.createElement('li');
                    li.textContent = insight;
                    insightsList.appendChild(li);
                });
                
                spendingInsights.appendChild(insightsList);
            }
        }
        
        // Get date range for report
        function getDateRangeForReport(rangeType) {
            const currentDate = new Date();
            let startDate, endDate, labels;
            
            if (rangeType === 'thisMonth') {
                // This month
                startDate = new Date(currentDate.getFullYear(), currentDate.getMonth(), 1);
                endDate = new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 0);
                
                // Create labels for each day of the month
                labels = Array.from({ length: endDate.getDate() }, (_, i) => `${i + 1}`);
            } else if (rangeType === 'lastMonth') {
                // Last month
                startDate = new Date(currentDate.getFullYear(), currentDate.getMonth() - 1, 1);
                endDate = new Date(currentDate.getFullYear(), currentDate.getMonth(), 0);
                
                // Create labels for each day of the month
                labels = Array.from({ length: endDate.getDate() }, (_, i) => `${i + 1}`);
            } else if (rangeType === 'last3Months') {
                // Last 3 months
                startDate = new Date(currentDate.getFullYear(), currentDate.getMonth() - 2, 1);
                endDate = new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 0);
                
                // Create labels for each week
                const weeks = Math.ceil((endDate - startDate) / (7 * 24 * 60 * 60 * 1000));
                labels = Array.from({ length: weeks }, (_, i) => `Week ${i + 1}`);
            } else if (rangeType === 'thisYear') {
                // This year
                startDate = new Date(currentDate.getFullYear(), 0, 1);
                endDate = new Date(currentDate.getFullYear(), 11, 31);
                
                // Create labels for each month
                labels = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
            } else {
                // All time
                startDate = new Date(0); // Beginning of time
                endDate = new Date(); // Now
                
                // Create labels for each year
                const years = endDate.getFullYear() - startDate.getFullYear() + 1;
                labels = Array.from({ length: years }, (_, i) => `${startDate.getFullYear() + i}`);
            }
            
            return { startDate, endDate, labels };
        }
        
        // Format currency
        function formatCurrency(amount) {
            return amount.toLocaleString('en-US', {
                style: 'currency',
                currency: 'USD',
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            });
        }
        
        // Format date
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'short',
                day: 'numeric'
            });
        }
        
        // Initialize
        updateDashboard();
        updateBudgetForm();
        updateBudgetChart();
        
        // Set default date to today
        const today = new Date().toISOString().split('T')[0];
        transactionDate.value = today;
    </script>
</body>
</html>